{% extends "base.html" %}
{% block title %}Sign In or Sign Up Â· Flash Studio{% endblock %}

{% block content %}
<div class="auth-hero py-5">
  <div class="row justify-content-center">
    <div class="col-12 col-md-8 col-lg-5">
      <div class="card shadow auth-card">
        <div class="card-body p-4 p-md-5">
          <div class="text-center mb-4">
            <!-- Flash Studio Camera/Bolt emblem -->
            <svg width="48" height="48" viewBox="0 0 24 24" fill="none" aria-hidden="true">
              <rect x="3" y="6" width="18" height="12" rx="2" stroke="currentColor" opacity=".35" stroke-width="1.6"/>
              <path d="M11 6l-1.2-1.8A2 2 0 0 0 8.2 3H6.8A2 2 0 0 0 5 4.2L4.4 6" 
                    stroke="currentColor" opacity=".35" stroke-width="1.6" />
              <path d="M13.5 6L9.8 12h3.2l-2.5 6 5-7h-3z" fill="currentColor"/>
            </svg>
          </div>

          <!-- Auth Tabs -->
          <ul class="nav nav-tabs nav-fill mb-4" role="tablist">
            <li class="nav-item" role="presentation">
              <button class="nav-link {{ 'active' if not request.args.get('tab') or request.args.get('tab') == 'login' }}"
                      id="login-tab"
                      data-bs-toggle="tab"
                      data-bs-target="#login-form"
                      type="button"
                      role="tab">
                Sign In
              </button>
            </li>
            <li class="nav-item" role="presentation">
              <button class="nav-link {{ 'active' if request.args.get('tab') == 'register' }}"
                      id="register-tab"
                      data-bs-toggle="tab"
                      data-bs-target="#register-form"
                      type="button"
                      role="tab">
                Sign Up
              </button>
            </li>
          </ul>

          <div class="tab-content">
            <!-- Login Form -->
            <div class="tab-pane fade {{ 'show active' if not request.args.get('tab') or request.args.get('tab') == 'login' }}"
                 id="login-form"
                 role="tabpanel">
              <form method="post" action="{{ url_for('auth.login') }}" novalidate>
                <div class="mb-3">
                  <label class="form-label">Email address</label>
                  <input class="form-control form-control-lg" name="username" type="email" required>
                </div>
                <div class="mb-3">
                  <label class="form-label">Password</label>
                  <input class="form-control form-control-lg" type="password" name="password" required>
                </div>

                <div class="d-flex justify-content-between align-items-center mb-3">
                  <div class="form-check">
                    <input class="form-check-input" type="checkbox" id="remember-me">
                    <label class="form-check-label" for="remember-me">Remember me</label>
                  </div>
                  <a class="small" href="#">Forgot password?</a>
                </div>

                <button class="btn btn-primary btn-lg w-100">Sign In</button>

                {% if login_error %}
                  <div class="alert alert-danger mt-3">{{ login_error }}</div>
                {% endif %}
              </form>
            </div>

            <!-- Register Form -->
            <div class="tab-pane fade {{ 'show active' if request.args.get('tab') == 'register' }}"
                 id="register-form"
                 role="tabpanel">
              <form method="post" action="{{ url_for('auth.register') }}" novalidate>
                <div class="mb-3">
                  <label class="form-label">Email address</label>
                  <input class="form-control form-control-lg" name="email" type="email" required>
                </div>
                <div class="mb-3">
                  <label class="form-label">Password</label>
                  <input class="form-control form-control-lg" type="password" name="password" required>
                </div>
                <div class="mb-3">
                  <label class="form-label">Confirm Password</label>
                  <input class="form-control form-control-lg" type="password" name="confirm_password" required>
                </div>

                <div class="form-check mb-3">
                  <input class="form-check-input" type="checkbox" id="accept-terms" required>
                  <label class="form-check-label" for="accept-terms">
                    I agree to the Terms of Service and Privacy Policy
                  </label>
                </div>

                <button class="btn btn-primary btn-lg w-100">Create Account</button>

                {% if register_error %}
                  <div class="alert alert-danger mt-3">{{ register_error }}</div>
                {% endif %}
              </form>
            </div>
          </div>

          <!-- Social Sign In -->
          <div class="text-center mt-4">
            <p class="text-muted mb-4">Or continue with</p>
            <div class="d-flex gap-2 justify-content-center">
              <button class="btn btn-outline-secondary px-4">
                <svg width="20" height="20" fill="currentColor" class="me-2">
                  <use href="#google-icon"/>
                </svg>
                Google
              </button>
              <button class="btn btn-outline-secondary px-4">
                <svg width="20" height="20" fill="currentColor" class="me-2">
                  <use href="#facebook-icon"/>
                </svg>
                Facebook
              </button>
            </div>
          </div>
        </div>
      </div>
    </div>
  </div>
</div>

<!-- SVG Icons -->
<svg xmlns="http://www.w3.org/2000/svg" class="d-none">
  <symbol id="google-icon" viewBox="0 0 24 24">
    <path d="M12.48 10.92v3.28h7.84c-.24 1.84-.853 3.187-1.787 4.133-1.147 1.147-2.933 2.4-6.053 2.4-4.827 0-8.6-3.893-8.6-8.72s3.773-8.72 8.6-8.72c2.6 0 4.507 1.027 5.907 2.347l2.307-2.307C18.747 1.44 16.133 0 12.48 0 5.867 0 .307 5.387.307 12s5.56 12 12.173 12c3.573 0 6.267-1.173 8.373-3.36 2.16-2.16 2.84-5.213 2.84-7.667 0-.76-.053-1.467-.173-2.053H12.48z"/>
  </symbol>
  <symbol id="facebook-icon" viewBox="0 0 24 24">
    <path d="M24 12.073c0-6.627-5.373-12-12-12s-12 5.373-12 12c0 5.99 4.388 10.954 10.125 11.854v-8.385H7.078v-3.47h3.047V9.43c0-3.007 1.792-4.669 4.533-4.669 1.312 0 2.686.235 2.686.235v2.953H15.83c-1.491 0-1.956.925-1.956 1.874v2.25h3.328l-.532 3.47h-2.796v8.385C19.612 23.027 24 18.062 24 12.073z"/>
  </symbol>
</svg>
{% endblock %}

{% block scripts %}
<script>
// Handle form submission errors
document.addEventListener('DOMContentLoaded', function() {
  // Switch to register tab if there's a registration error
  if (document.querySelector('#register-form .alert-danger')) {
    document.querySelector('#register-tab').click();
  }
  
  // Password confirmation validation
  const registerForm = document.querySelector('#register-form form');
  const password = registerForm.querySelector('input[name="password"]');
  const confirm = registerForm.querySelector('input[name="confirm_password"]');
  
  function validatePassword() {
    if (password.value != confirm.value) {
      confirm.setCustomValidity("Passwords do not match");
    } else {
      confirm.setCustomValidity('');
    }
  }
  
  password.addEventListener('change', validatePassword);
  confirm.addEventListener('keyup', validatePassword);
});
</script>
{% endblock %}